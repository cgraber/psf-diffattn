from detectron2.config import CfgNode as CN


def add_forecast_config(cfg):

    cfg.EVAL_SEQ = False
    cfg.EVAL_DO_MATCHING = False
    cfg.EVAL_INSTANCE_SEGMENTATION = False
    cfg.EVAL_SEMANTIC_SEGMENTATION = False
    cfg.EVAL_PANOPTIC_SEGMENTATION = False
    cfg.PANOPTIC_SEGMENTATION_BG_DIR = None
    cfg.EVAL_WITH_DEPTH_SORTING = False
    cfg.EVAL_VIZ = False


    cfg.INPUT.USE_BOX_CROP = False
    cfg.INPUT.BOX_CROP_PCT = 0.5
    cfg.INPUT.BOX_CROP_MIN_WIDTH_PCT = None
    cfg.INPUT.GAUSSIAN_BLUR_PCT = 0.2
    cfg.INPUT.COLOR_DISTORT_PCT = 0.8
    cfg.INPUT.SAVED_FEAT_META_FILE = None
    cfg.INPUT.IMG_WIDTH = 2048
    cfg.INPUT.IMG_HEIGHT = 1024
    cfg.INPUT.SAVED_FEAT_PATH = None
    cfg.INPUT.MIN_BOX_AREA = None
    cfg.INPUT.SAVED_BG_LOGIT_PATH = None
    cfg.INPUT.SAVED_BG_FEAT_PATH = None
    cfg.INPUT.SAVED_BG_DEPTH_PATH = None
    cfg.INPUT.SAVED_BG_DEPTH_DIR = None
    cfg.INPUT.SAVED_PRED_ODOM_PATH = None
    cfg.INPUT.TARGET_FRAME = None
    cfg.INPUT.ORBSLAM_ODOM_META_PATH = None
    


    cfg.EVAL_IDS = False
    cfg.EVAL_PQ = False
    cfg.TEST.LOSS_EVAL_PERIOD = 500
    cfg.SOLVER.GRAD_ACCUMULATE_STEPS = None
    cfg.SOLVER.OPTIMIZER = 'SGD'
    cfg.SOLVER.MIN_LR = 1e-6
    cfg.SOLVER.T0 = 6000
    cfg.SOLVER.T_MULT = 1
    cfg.INPUT.SEQ_LEN = 6
    cfg.INPUT.SEQ_INTERVAL = 1
    cfg.INPUT.USE_ID = False
    cfg.INPUT.TARGET_FRAME_RANGE = None
    cfg.INPUT.USE_REVERSE_AUG = False
    cfg.MODEL.KEY_MODE = 'standard'
    cfg.MODEL.VALUE_MODE = 'standard'
    cfg.MODEL.FORECAST_LEN = 3
    cfg.MODEL.START_IDXS = None
    cfg.MODEL.ODOM_MEAN = [6.2783e+00, 1.8357e-03, 3.2054e-01, 1.9058e-05, 9.2651e-05]
    cfg.MODEL.ODOM_STD =  [3.5678e+00, 6.2480e-02, 2.6960e-01, 2.3288e-03, 3.5222e-03]
    cfg.MODEL.ODOM_SIZE = 5
    cfg.MODEL.USE_PRE_NORM = False
    cfg.MODEL.LOSS_DIST_THRESHOLD = None
    cfg.MODEL.EDGE_DIST_THRESHOLD = None
    cfg.MODEL.USE_SAVED_FEAT_MODE = False
    cfg.MODEL.SAVE_SEQ_FEATS = False
    cfg.MODEL.IOU_COEF = 1.0
    cfg.MODEL.DIST_COEF = 1.0
    cfg.MODEL.USE_BOX_CWH = False
    cfg.MODEL.BOX_MEAN = [1024.2140,  500.8155,  300.6620,  299.2760]
    cfg.MODEL.BOX_STD = [434.4583, 181.2670, 116.7715, 114.2770]
    cfg.MODEL.USE_BOX_POSITIONAL_ENCODING = False
    cfg.MODEL.BOX_POSITIONAL_ENCODING_SIZE = 256
    cfg.MODEL.MAX_ID = 128
    cfg.MODEL.SUB_BATCH_SIZE = None
    cfg.MODEL.USE_INPUT_FEATS_V2 = False
    cfg.MODEL.RNN_HIDDEN_SIZE = 512
    cfg.MODEL.FREEZE_VIZ_EMB = False
    cfg.MODEL.USE_DEPTHS = False
    cfg.MODEL.DEPTH_LOSS_COEF = 1.0
    cfg.MODEL.DEPTH_MEAN = 47.42
    cfg.MODEL.DEPTH_STD = 32.30
    cfg.MODEL.USE_CLASS_INP = False
    cfg.MODEL.CLASS_EMB_SIZE = 32
    cfg.MODEL.USE_SPLIT_EMB = False
    cfg.MODEL.ENCODER_EMBEDDING_LOSS_COEF = None
    cfg.MODEL.ENC_DEC_EMBEDDING_LOSS_COEF = None
    cfg.MODEL.PRESENCE_LOSS_COEF = None
    cfg.MODEL.ONE_HOT_BOX_SIZE = None
    cfg.MODEL.WEIGHT_DIST_BY_IOU = False
    cfg.MODEL.USE_EMB_MATCHING = False
    cfg.MODEL.EMB_MATCH_COEF = 1.0
    cfg.MODEL.EMB_LOSS_COEF = 1.0
    cfg.MODEL.IOU_THRESHOLD = 0.0
    cfg.MODEL.EMB_THRESHOLD = 0.0
    cfg.MODEL.ENCODE_ENTIRE_SEQUENCE = False
    cfg.MODEL.FILTER_BY_DEPTH = False
    cfg.MODEL.DEPTH_THRESH = 30
    cfg.MODEL.USE_INP_EMB_FOR_MATCHING = False
    cfg.MODEL.DETACH_AGENT_AWARE_MASK = False
    cfg.MODEL.NORMALIZE_EMBS = False
    cfg.MODEL.EXTRA_MATCH_BOXES = None
    cfg.MODEL.USE_CLASS_MASKING = False
    cfg.MODEL.AGENT_AWARE_TEMPERATURE = 1.0
    cfg.MODEL.VIZ_EMB_SIZE = 256
    cfg.MODEL.VIZ_EMB_NORM_COEF = None
    cfg.MODEL.DEPTH_MATCH_COEF = None
    cfg.MODEL.SHARE_FEAT_MODELS = False
    cfg.MODEL.VIZEMB_PRETRAIN_PATH = None
    cfg.MODEL.USE_GT_BOXES = False
    cfg.MODEL.EVAL_WITH_START_BOXES = False
    cfg.MODEL.VEL_EMB_NORM_COEF = 0.1
    cfg.MODEL.VEL_ANGLE_THRESH = None
    cfg.MODEL.USE_SYMMETRIC_EMB_LOSS = False
    cfg.MODEL.USE_AGENT_AWARE_MASK_MATCHING = False
    cfg.MODEL.MASK_FEAT_LOSS_COEF = None
    cfg.MODEL.DECODER_MASK_LOGIT_LOSS_COEF = None
    cfg.MODEL.DECODER_MASK_LOSS_COEF = None
    cfg.MODEL.ENCODER_NEXT_MASK_FEAT_LOSS_COEF = None
    cfg.MODEL.ENCODER_NEXT_MASK_LOGIT_LOSS_COEF = None
    cfg.MODEL.ENCODER_NEXT_MASK_LOSS_COEF = None
    cfg.MODEL.ENCODER_MASK_LOSS_COEF = None
    cfg.MODEL.ENCODER_MASK_LOGIT_LOSS_COEF = None
    cfg.MODEL.PREDICT_PRESENCE = False
    cfg.MODEL.BINARIZE_LOSS_MASKS = False
    cfg.MODEL.USE_CL_MASK_EMB = False
    cfg.MODEL.USE_MASK_FOCAL_LOSS = False
    cfg.MODEL.MASK_FOCAL_LOSS_GAMMA = 2.0
    cfg.MODEL.SPLIT_OUTPUT_EMB = False
    cfg.MODEL.SAVED_FEAT_PRED_MASKS = False
    cfg.MODEL.FIX_TRANSFORMER_INIT = False
    cfg.MODEL.VEL_OUT_FACTOR = 1.0
    cfg.MODEL.USE_TARGET_FRAME_INPUTS = False
    cfg.MODEL.USE_TARGET_FRAME_INPUTS_ONLY = False
    cfg.MODEL.TARGET_FRAME_INPUT_PROB = 0.5
    cfg.MODEL.CL_INP_TYPE = 'one_hot'
    cfg.MODEL.USE_PRED_FUTURE_ODOMETRY = False
    cfg.MODEL.PRED_INDEX = -1

    cfg.MODEL.BACKBONE.FREEZE = False
    cfg.MODEL.ROI_HEADS.FREEZE = True
    cfg.MODEL.USE_FULL_SEQ_ENCODER_LOSS = False
    cfg.MODEL.DECODER_MATCH_WITH_ENC_IDS = False
    cfg.MODEL.USE_SEPARATE_MASK_MODEL = False
    cfg.MODEL.MASK_MODEL_ONLY = False
    cfg.MODEL.USE_SIMPLE_EMB = False
    cfg.MODEL.NUM_FEAT_LAYERS = 1
    cfg.MODEL.USE_SMALL_OUTPUT_INIT = False
    cfg.MODEL.ADD_FINAL_REFINE = False

    cfg.MODEL.TRAJECTORY_ENCODER = CN()
    cfg.MODEL.TRAJECTORY_ENCODER.TYPE = 'standard'
    cfg.MODEL.TRAJECTORY_ENCODER.FEAT_CHANNELS = 3
    cfg.MODEL.TRAJECTORY_ENCODER.EMB_SIZE = 256
    cfg.MODEL.TRAJECTORY_ENCODER.NUM_LAYERS = 2
    cfg.MODEL.TRAJECTORY_ENCODER.NUM_ATTENTION_HEADS = 8
    cfg.MODEL.TRAJECTORY_ENCODER.DIM_FEEDFORWARD = 512
    cfg.MODEL.TRAJECTORY_ENCODER.DROPOUT = 0.1
    cfg.MODEL.TRAJECTORY_ENCODER.USE_ODOM = False
    cfg.MODEL.TRAJECTORY_ENCODER.TEMPERATURE = 1.0
    cfg.MODEL.TRAJECTORY_ENCODER.ATTENTION_TYPE = 'dot_product'
    cfg.MODEL.TRAJECTORY_ENCODER.AGGREGATION_TYPE = 'normal'
    cfg.MODEL.TRAJECTORY_ENCODER.NO_VIZ = False
    cfg.MODEL.TRAJECTORY_ENCODER.ATTENTION_MODULE = 'standard'
    cfg.MODEL.TRAJECTORY_ENCODER.USE_CAUSAL_MASK = False
    cfg.MODEL.TRAJECTORY_ENCODER.VIZ_DROPOUT = None
    cfg.MODEL.TRAJECTORY_ENCODER.BOX_EMBED_SIZE = 256
    cfg.MODEL.TRAJECTORY_ENCODER.USE_NO_MATCH_EMB = False
    cfg.MODEL.TRAJECTORY_ENCODER.ATTENTION_DIST_THRESH = None
    cfg.MODEL.TRAJECTORY_ENCODER.USE_VEL = True
    cfg.MODEL.TRAJECTORY_ENCODER.ADD_ZERO_ATTN = False
    cfg.MODEL.TRAJECTORY_ENCODER.IS_AGENT_AWARE = False
    cfg.MODEL.TRAJECTORY_ENCODER.PREDICT_LOC = False
    cfg.MODEL.TRAJECTORY_ENCODER.PREDICT_VEL = False
    cfg.MODEL.TRAJECTORY_ENCODER.PREDICT_INTERMEDIATE_VEL = False
    cfg.MODEL.TRAJECTORY_ENCODER.MLP_HIDDEN = [512, 256]
    cfg.MODEL.TRAJECTORY_ENCODER.FEAT_USE_RELUS = False
    cfg.MODEL.TRAJECTORY_ENCODER.USE_FIXED_BOX_VELS = True
    cfg.MODEL.TRAJECTORY_ENCODER.SECOND_STAGE_FROM_BOX = False
    cfg.MODEL.TRAJECTORY_ENCODER.PREDICT_MASK_FEATS = False
    cfg.MODEL.TRAJECTORY_ENCODER.PREDICT_MASK = False
    cfg.MODEL.TRAJECTORY_ENCODER.USE_SEG_MASK_INPUT = False
    cfg.MODEL.TRAJECTORY_ENCODER.USE_SEG_MASK_PROBS = False
    cfg.MODEL.TRAJECTORY_ENCODER.PREDICT_SEPARATE_MASK_PER_CLASS = False
    cfg.MODEL.TRAJECTORY_ENCODER.PREDICT_PRESENCE = False
    cfg.MODEL.NUM_THINGS_CLASSES = 8
    cfg.MODEL.NUM_STUFF_CLASSES = 11

    cfg.MODEL.TRAJECTORY_DECODER = CN()
    cfg.MODEL.TRAJECTORY_DECODER.EMB_SIZE = 256
    cfg.MODEL.TRAJECTORY_DECODER.NUM_LAYERS = 2
    cfg.MODEL.TRAJECTORY_DECODER.NUM_ATTENTION_HEADS = 8
    cfg.MODEL.TRAJECTORY_DECODER.DIM_FEEDFORWARD = 512
    cfg.MODEL.TRAJECTORY_DECODER.DROPOUT = 0.1
    cfg.MODEL.TRAJECTORY_DECODER.USE_ODOM = False
    cfg.MODEL.TRAJECTORY_DECODER.TEMPERATURE = 1.0
    cfg.MODEL.TRAJECTORY_DECODER.ATTENTION_TYPE = 'dot_product'
    cfg.MODEL.TRAJECTORY_DECODER.AGGREGATION_TYPE = 'normal'
    cfg.MODEL.TRAJECTORY_DECODER.IS_AGENT_AWARE = False
    cfg.MODEL.TRAJECTORY_DECODER.USE_FEATS_AND_DIFF = False
    cfg.MODEL.TRAJECTORY_DECODER.ATTENTION_MODULE = 'standard'
    cfg.MODEL.TRAJECTORY_DECODER.PREDICT_OFFSET_FROM_START = False
    cfg.MODEL.TRAJECTORY_DECODER.PREDICT_LOC = False
    cfg.MODEL.TRAJECTORY_DECODER.ATTENTION_DIST_THRESH = None
    cfg.MODEL.TRAJECTORY_DECODER.USE_VEL = False
    cfg.MODEL.TRAJECTORY_DECODER.ADD_ZERO_ATTN = False
    cfg.MODEL.TRAJECTORY_DECODER.FEAT_USE_RELUS = False
    cfg.MODEL.TRAJECTORY_DECODER.USE_VIZ_FEATS = False
    cfg.MODEL.TRAJECTORY_DECODER.PREDICT_MASK_FEATS = False
    cfg.MODEL.TRAJECTORY_DECODER.PREDICT_MASK = False
    cfg.MODEL.TRAJECTORY_DECODER.USE_SEG_MASK_PROBS = False
    cfg.MODEL.TRAJECTORY_DECODER.PREDICT_SEPARATE_MASK_PER_CLASS = False
    cfg.MODEL.TRAJECTORY_DECODER.PREDICT_PRESENCE = False
    cfg.MODEL.TRAJECTORY_DECODER.BOX_EMBED_SIZE = None
    cfg.MODEL.TRAJECTORY_DECODER.USE_NO_MATCH_EMB = False


    cfg.MODEL.VIZ_EMBED = CN()
    cfg.MODEL.VIZ_EMBED.NUM_CONV = 0 
    cfg.MODEL.VIZ_EMBED.CONV_DIM = 256
    cfg.MODEL.VIZ_EMBED.NUM_FC = 2
    cfg.MODEL.VIZ_EMBED.FC_DIM = 1024
    cfg.MODEL.VIZ_EMBED.NORM = ""
    cfg.MODEL.VIZ_EMBED.EMB_SIZE = 256


    cfg.MODEL.MASK_ENCODER = CN()
    cfg.MODEL.MASK_ENCODER.EMB_SIZE = 1024
    cfg.MODEL.MASK_ENCODER.NUM_LAYERS = 2
    cfg.MODEL.MASK_ENCODER.NUM_ATTENTION_HEADS = 8
    cfg.MODEL.MASK_ENCODER.DIM_FEEDFORWARD = 2048
    cfg.MODEL.MASK_ENCODER.DROPOUT = 0.1
    cfg.MODEL.MASK_ENCODER.USE_ODOM = False
    cfg.MODEL.MASK_ENCODER.PREDICTION_TYPE = 'mask_feats'
    cfg.MODEL.MASK_ENCODER.ATTENTION_TYPE = 'dot_product'
    cfg.MODEL.MASK_ENCODER.AGGREGATION_TYPE = 'normal'
    cfg.MODEL.MASK_ENCODER.ATTENTION_MODULE = 'standard'
    cfg.MODEL.MASK_ENCODER.IS_AGENT_AWARE = False
    cfg.MODEL.MASK_ENCODER.PREDICT_MASK_FEATS = False
    cfg.MODEL.MASK_ENCODER.PREDICT_MASK = False
    cfg.MODEL.MASK_ENCODER.ENC_TYPE = 'feat'
    cfg.MODEL.MASK_ENCODER.TIME_SIZE = None
    cfg.MODEL.MASK_ENCODER.KEY_DIM = None
    cfg.MODEL.MASK_ENCODER.TRANSFORMER_TYPE = 'standard'
    cfg.MODEL.MASK_ENCODER.KERNEL_SIZE = 3
    cfg.MODEL.MASK_ENCODER.ATTN_KERNEL_SIZE = 3
    cfg.MODEL.MASK_ENCODER.FEEDFORWARD_KERNEL_SIZE = 3
    cfg.MODEL.MASK_ENCODER.FEAT_KERNEL_SIZE = 3

    cfg.MODEL.MASK_DECODER = CN()
    cfg.MODEL.MASK_DECODER.EMB_SIZE = 1024
    cfg.MODEL.MASK_DECODER.NUM_LAYERS = 2
    cfg.MODEL.MASK_DECODER.NUM_ATTENTION_HEADS = 8
    cfg.MODEL.MASK_DECODER.DIM_FEEDFORWARD = 2048
    cfg.MODEL.MASK_DECODER.DROPOUT = 0.1
    cfg.MODEL.MASK_DECODER.USE_ODOM = False
    cfg.MODEL.MASK_DECODER.PREDICTION_TYPE = 'mask_feats'
    cfg.MODEL.MASK_DECODER.ATTENTION_TYPE = 'dot_product'
    cfg.MODEL.MASK_DECODER.AGGREGATION_TYPE = 'normal'
    cfg.MODEL.MASK_DECODER.ATTENTION_MODULE = 'standard'
    cfg.MODEL.MASK_DECODER.IS_AGENT_AWARE = False
    cfg.MODEL.MASK_DECODER.DEC_TYPE = 'feat'
    cfg.MODEL.MASK_DECODER.ENC_TYPE = 'feat'
    cfg.MODEL.MASK_DECODER.KEY_DIM = None
    cfg.MODEL.MASK_DECODER.TRANSFORMER_TYPE = 'standard'
    cfg.MODEL.MASK_DECODER.KERNEL_SIZE = 3
    cfg.MODEL.MASK_DECODER.FEAT_KERNEL_SIZE = 3
    cfg.MODEL.MASK_DECODER.ATTN_KERNEL_SIZE = 3
    cfg.MODEL.MASK_DECODER.FEEDFORWARD_KERNEL_SIZE = 3
    cfg.MODEL.MASK_DECODER.FEAT_NUM_LAYERS = 1


    cfg.MODEL.FGBGREFINE = CN()
    cfg.MODEL.FGBGREFINE.NAME = 'FGBGRefiner'
    cfg.MODEL.FGBGREFINE.PREDICTION_STRIDE = 4
    cfg.MODEL.FGBGREFINE.DEPTH_BUCKETS = [0,1,2,3,4,5,6,7,8,10,12,14,16,18,20,22,28,26,28,30,32,34,36,38,40,48,56,64,72,80,88,144,200]
    cfg.MODEL.FGBGREFINE.DEPTH_BUCKET_RANGE = None
    cfg.MODEL.FGBGREFINE.USE_SINGLE_BG_DEPTH = False
    cfg.MODEL.FGBGREFINE.IOU_MATCHING_THRESHOLD = 0.8
    cfg.MODEL.FGBGREFINE.SUPERVISE_CORRECT_BG = False
    cfg.MODEL.FGBGREFINE.SUPERVISE_OVERLAPPING_FG = False
    cfg.MODEL.FGBGREFINE.TRAIN_PASTE_INTO_GT_BOX = False
    cfg.MODEL.FGBGREFINE.USE_ID_MATCHING = False
    cfg.MODEL.FGBGREFINE.USE_INSTANCE_FEATURES = False
    cfg.MODEL.FGBGREFINE.MAX_INST_NUM = None
    cfg.MODEL.FGBGREFINE.SUB_BATCH_SIZE = None
    cfg.MODEL.FGBGREFINE.TRAIN_GT_DEPTH = False
    cfg.MODEL.FGBGREFINE.BG_FRONT_WEIGHT = None
    cfg.MODEL.FGBGREFINE.USE_DEPTH_REFINE_MODEL = False
    cfg.MODEL.FGBGREFINE.USE_DEPTH_OFFSET_BIAS = False
    cfg.MODEL.FGBGREFINE.DEPTH_OFFSET_COEF = 1.0
    cfg.MODEL.FGBGREFINE.PASTE_FULL_REZ_INSTANCES = False
    cfg.MODEL.FGBGREFINE.USE_GT_PAN_SEG = False
    cfg.MODEL.FGBGREFINE.USE_FOCAL_LOSS = False
    cfg.MODEL.FGBGREFINE.FOCAL_LOSS_GAMMA = 2
    cfg.MODEL.FGBGREFINE.TRUSTFG = True
    cfg.MODEL.FGBGREFINE.VIZ_DEPTHS = False
    cfg.MODEL.FGBGREFINE.USE_BG_FEATS = False
    cfg.MODEL.FGBGREFINE.INST_DEPTH_FACTOR = 1.0

    cfg.MODEL.FGBGREFINE.STATIC_LAYERS = 5
    cfg.MODEL.FGBGREFINE.DYN_LAYERS = 1
    cfg.MODEL.FGBGREFINE.EMB_SIZE = 64
    cfg.MODEL.FGBGREFINE.NUM_HEADS = 1

    cfg.MODEL.FGBGREFINE.TRANSFORMER = CN()
    cfg.MODEL.FGBGREFINE.TRANSFORMER.SOFTMAX_FULL_MATRIX = False